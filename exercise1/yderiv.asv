function dydz=yderiv(z,y)
global molmass rhob pb0 Cp enthalpy U dt Tr R;
pA = y(1); 
T = y(2);
ptot = y(3);
us = y(4);
f=1;
dp=0.1;
k=1.0e-10*exp(19.837-13636.0/T)/3600.0; 
r=k*pb0*pA; 
rhog=ptot*molmass/(R*T);
dptdz=f*rhog*us^2/dp;
dTdz=1.0/(us*rhog*Cp)*(enthalpy*rhob*r-4.0*U/dt*(T-Tr));
dusdz=-us*molmass/(rhog*R)*(1/T*dptdz+);
dpAdz=-1.0/us*(molmass*ptot*rhob/rhog*r)+pA/T*dTdz+pA/us*dusdz;



dydz=[dpdz;dTdz];
end


